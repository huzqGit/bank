<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cooperation">
<sql id="Cooperation_Column_List" >
   organ_id,cooperationid, cooperationname,orgaCode, taxcode, registeraddress, mailaddress,
   registerdate, registercapital, realcapital, legalperson, idnum, phone, members,
   businesScope, businessarea, farmers, connectionbase, recorder, recordtime
</sql>
<insert id="save" useGeneratedKeys="true" keyProperty="cooperationId" 
	parameterType="com.bank.beans.FarmerCooperation">
	insert into t_cooperation
	<trim prefix="(" suffix=")" suffixOverrides=",">
		<if test="organ_id != null">
			organ_id,
		</if>
		<if test="cooperationName != null">
			cooperationName,
		</if>
		<if test="orgaCode != null">
			orgaCode,
		</if>
   		<if test="taxCode != null">
   			taxCode,
   		</if>
		<if test="registerAddress != null">
			registerAddress,
		</if>
   		<if test="mailAddress != null">
   			mailAddress,
   		</if>
   		<if test ="registerDate != null">
   			registerDate,
   		</if>
   		<if test="registerCapital != null">
   			registerCapital,
   		</if>
   		<if test="realCapital != null">
   			realCapital,
   		</if>
  		<if test="legalPerson != null">
  			legalPerson,
  		</if>
		<if test="idNum != null">
			idNum,
		</if>
   		<if test="phone != null">
   			phone,
   		</if>
		<if test="members != null">
			members,
		</if>
		<if test="businesScope != null">
			businesScope,
		</if>
		<if test="businessArea != null">
			businessArea,
		</if>
		<if test="farmers != null">
			farmers,
		</if>
		<if test="connectionBase != null">
			connectionBase,
		</if>
   		<if test="recorder != null">
   			recorder,
   		</if>
  		<if test="recordTime != null">
  			recordTime
  		</if>
	</trim>
	<trim prefix="values (" suffix=")" suffixOverrides=",">
		<if test="organ_id != null">
			#{organ_id,jdbcType=VARCHAR},
		</if>
		<if test="cooperationName != null">
			#{cooperationName,jdbcType=VARCHAR},
		</if>
		<if test="orgaCode != null">
			#{orgaCode,jdbcType=VARCHAR},
		</if>
   		<if test="taxCode != null">
   			#{taxCode,jdbcType=VARCHAR},
   		</if>
		<if test="registerAddress != null">
			#{registerAddress,jdbcType=VARCHAR},
		</if>
   		<if test="mailAddress != null">
   			#{mailAddress,jdbcType=VARCHAR},
   		</if>
   		<if test ="registerDate != null">
   			#{registerDate,jdbcType=DATE},
   		</if>
   		<if test="registerCapital != null">
   			#{registerCapital,jdbcType=VARCHAR},
   		</if>
   		<if test="realCapital != null">
   			#{realCapital,jdbcType=VARCHAR},
   		</if>
  		<if test="legalPerson != null">
  			#{legalPerson,jdbcType=VARCHAR},
  		</if>
		<if test="idNum != null">
			#{idNum,jdbcType=VARCHAR},
		</if>
   		<if test="phone != null">
   			#{phone,jdbcType=VARCHAR},
   		</if>
		<if test="members != null">
			#{members,jdbcType=INTEGER},
		</if>
		<if test="businesScope != null">
			#{businesScope,jdbcType=VARCHAR},
		</if>
		<if test="businessArea != null">
			#{businessArea,jdbcType=INTEGER},
		</if>
		<if test="farmers != null">
			#{farmers,jdbcType=INTEGER},
		</if>
		<if test="connectionBase != null">
			#{connectionBase,jdbcType=VARCHAR},
		</if>
   		<if test="recorder != null">
   			#{recorder,jdbcType=VARCHAR},
   		</if>
  		<if test="recordTime != null">
  			#{recordTime,jdbcType=TIMESTAMP}
  		</if>
	</trim>
</insert>
<update id="update" parameterType="com.bank.beans.FarmerCooperation">
	update t_cooperation
	<set>
		<if test="organ_id != null and organ_id != ''">organ_id = #{organ_id},</if>
		<if test="members != null and members != ''">members = #{members},</if>
		<if test="cooperationName != null and cooperationName != ''">cooperationname = #{cooperationName},</if>
		<if test="orgaCode != null and orgaCode != ''">orgaCode = #{orgaCode},</if>
		<if test="taxCode != null and taxCode != ''">taxcode = #{taxCode},</if>
		<if test="registerAddress != null and registerAddress != ''">registeraddress = #{registerAddress},</if>
		<if test="mailAddress != null and mailAddress != ''">mailaddress = #{mailAddress},</if>
	   	<if test="registerDate != null and registerDate != ''">registerdate = #{registerDate},</if>
	   	<if test="registerCapital != null and registerCapital != ''">registercapital = #{registerCapital},</if>
	   	<if test="realCapital != null and realCapital != ''">realcapital = #{realCapital},</if>
	   	<if test="legalPerson != null and legalPerson != ''">legalperson = #{legalPerson},</if>
	   	<if test="idNum != null and idNum != ''">idnum = #{idNum},</if>
	   	<if test="phone != null and phone != ''">phone = #{phone}, </if>
	   	<if test="businesScope != null and businesScope != ''">businesscope = #{businesScope},</if>
	   	<if test="businessArea != null and businessArea != ''">businessarea = #{businessArea},</if>
	   	<if test="farmers != null and farmers != ''">farmers = #{farmers},</if>
	   	<if test="connectionBase != null and connectionBase != ''">connectionbase = #{connectionBase},</if>
	   	<if test="recorder != null and recorder != ''">recorder = #{recorder},</if>
	   	<if test="recordTime != null and recordTime != ''">recordtime = #{recordTime}</if>
	</set>
	   	where cooperationid = #{cooperationId}
</update>
<select id="findByPK" parameterType="Long" 
		resultType="com.bank.beans.FarmerCooperation">
	select 
	<include refid="Cooperation_Column_List" />
	from t_cooperation where cooperationid = #{id,jdbcType=INTEGER}
</select>
<select id="getPageingEntities" parameterType="map"
	resultType="com.bank.beans.FarmerCooperation">
   SELECT t.* FROM t_cooperation t,
	(select cooperationid, ROW_NUMBER() OVER () as rn from t_cooperation) AS t1 where t1.cooperationid= t.cooperationid
   <if test="cooperationName != null and cooperationName != ''">
  		and t.cooperationName like '%${cooperationName}%'
   </if>
   <if test="orgaCode != null and orgaCode != ''">
   		and t.orgaCode like '%${orgaCode}%'
   </if>
   <if test="organ_id != null and organ_id != ''">
   		and t.organ_id = '${organ_id}'
   </if>
   <if test="recorder != null and recorder != ''">
   		and t.recorder like '%${recorder}%'
   </if>
   <if test="organ_id != null and organ_id != ''">
   		and t.organ_id like '%${organ_id}%'
   </if>
   <if test="recordTimeBegin !=null and recordTimeBegin != ''">
   	  <![CDATA[and t.recordtime >=to_date('${recordTimeBegin}','yyyy-mm-dd')]]>
   </if>
   <if test="recordTimeEnd !=null and recordTimeEnd != ''">
   	  <![CDATA[and t.recordtime <=to_date('${recordTimeEnd}','yyyy-mm-dd')]]>
   </if>
   <if test="start != null">
  		<![CDATA[ and  t1.rn > #{start}	]]>
   </if>
   <if test="end != null">
  		<![CDATA[	and t1.rn <= #{end}		]]>
   </if>
   <choose>
	   <when test="sortField != null and sortField != ''">
	   		<![CDATA[ order by ${sortField} ${sortOrder}	]]>
	   </when>
	   <otherwise>
	   		order by t.cooperationid desc
	   </otherwise>
   </choose>
</select>
<select id="getTotal" parameterType="map" resultType="long">
	select count(*) from t_cooperation t where 1=1
   <if test="cooperationName != null and cooperationName != ''">
  		and t.cooperationName like '%${cooperationName}%'
   </if>
   <if test="organ_id != null and organ_id != ''">
   		and t.organ_id = '${organ_id}'
   </if>
   <if test="orgaCode != null and orgaCode != ''">
   		and t.orgaCode like '%${orgaCode}%'
   </if>
   <if test="recorder != null and recorder != ''">
   		and t.recorder like '%${recorder}%'
   </if>
   <if test="recordTimeBegin !=null and recordTimeBegin != ''">
   	  <![CDATA[and t.recordtime >=to_date('${recordTimeBegin}','yyyy-mm-dd')]]>
   </if>
   <if test="recordTimeEnd !=null and recordTimeEnd != ''">
   	  <![CDATA[and t.recordtime <=to_date('${recordTimeEnd}','yyyy-mm-dd')]]>
   </if>
</select>

<select id="getCooperationTree" parameterType="map" resultType="java.util.HashMap">
   select distinct COOPERATIONNAME as "id",t.COOPERATIONNAME as "name",'pn' as "pid" from t_cooperation t where 1=1
   <if test="cooperationName != null and cooperationName != ''">
  		and t.cooperationName like '%${cooperationName}%'
   </if>
</select>

<select id="getUnitId" parameterType="map" resultType="long">
	select COOPERATIONID from t_cooperation t where 1=1 
	and t.organ_id = '${organ_id}'
	and t.orgaCode = '${orgaCode}'
	FETCH FIRST 1 ROWS ONLY
</select>

<delete id="delete" parameterType="long">
	delete from t_cooperation where cooperationid = #{id,jdbcType=INTEGER}
</delete>
</mapper>