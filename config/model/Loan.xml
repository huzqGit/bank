<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 名称空间有特殊的用途 -->
<mapper namespace="loan">
<sql id="Loan_Column_List" >
     loanId,   clientNum,   noteNum,   compactNum,   loanDate,   limitDate,
     limitDate1,  currency, amount,   balance,   oweInterest,   currentRate,
     clientId,   clientName,   clientType,   idType,   idNum,   phone,  address,
     loanUse,  guaranteeType,  grade,   grade1,   settleType,   chargePerson,
     organCode,   organName,  businessType,   businessBody,   provideType,
     invest,   termType,   guaranteeType1,   floatScope,   adjustType,
     runType,  frequeency, runitId, runitName
</sql>
<resultMap id="loanResultMap" type="com.bank.beans.Loan" >
  <id column="loanid" property="id" jdbcType="BIGINT" />
  <result column="clientNum" property="clientNum" jdbcType="VARCHAR" />
  <result column="noteNum" property="noteNum" jdbcType="VARCHAR" />
  <result column="compactNum" property="compactNum" jdbcType="VARCHAR" />
  <result column="loanDate" property="loanDate" jdbcType="VARCHAR" />
  <result column="limitDate1" property="limitDate1" jdbcType="VARCHAR" />
  <result column="currency" property="currency" jdbcType="VARCHAR" />
  <result column="amount" property="amount" jdbcType="VARCHAR" />
  <result column="balance" property="balance" jdbcType="VARCHAR" />
  <result column="oweInterest" property="oweInterest" jdbcType="VARCHAR" />
  <result column="currentRate" property="currentRate" jdbcType="VARCHAR" />
  <result column="clientId" property="clientId" jdbcType="BIGINT" />
  <result column="clientName" property="clientName" jdbcType="VARCHAR" />
  <result column="clientType" property="clientType" jdbcType="VARCHAR" />
  <result column="idType" property="idType" jdbcType="VARCHAR" />
  <result column="idNum" property="idNum" jdbcType="VARCHAR" />
  <result column="loanUse" property="loanUse" jdbcType="VARCHAR" />
  <result column="guaranteeType" property="guaranteeType" jdbcType="VARCHAR" />
  <result column="grade" property="grade" jdbcType="VARCHAR" />
  <result column="grade1" property="grade1" jdbcType="VARCHAR" />
  <result column="settleType" property="settleType" jdbcType="VARCHAR" />
  <result column="chargePerson" property="chargePerson" jdbcType="VARCHAR" />
  <result column="organCode" property="organCode" jdbcType="VARCHAR" />
  <result column="organName" property="organName" jdbcType="VARCHAR" />
  <result column="businessType" property="businessType" jdbcType="VARCHAR" />
  <result column="businessBody" property="businessBody" jdbcType="VARCHAR" />
  <result column="provideType" property="provideType" jdbcType="VARCHAR" />
  <result column="invest" property="invest" jdbcType="VARCHAR" />
  <result column="termType" property="termType" jdbcType="VARCHAR" />
  <result column="guaranteeType1" property="guaranteeType1" jdbcType="VARCHAR" />
  <result column="floatScope" property="floatScope" jdbcType="VARCHAR" />
  <result column="adjustType" property="adjustType" jdbcType="VARCHAR" />
  <result column="runType" property="runType" jdbcType="VARCHAR" />
  <result column="frequeency" property="frequeency" jdbcType="VARCHAR" />
  <result column="runitId" property="runitId" jdbcType="VARCHAR" />
  <result column="runitName" property="runitName" jdbcType="VARCHAR" />
</resultMap>
<resultMap id="loanResultMap1" type="com.bank.beans.Loan" >
  <id column="loanid" property="id" jdbcType="BIGINT" />
  <result column="farmerName" property="farmerName" jdbcType="VARCHAR" />
  <result column="farmerIdNum" property="farmerIdNum" jdbcType="VARCHAR" />
  <result column="clientNum" property="clientNum" jdbcType="VARCHAR" />
  <result column="noteNum" property="noteNum" jdbcType="VARCHAR" />
  <result column="compactNum" property="compactNum" jdbcType="VARCHAR" />
  <result column="loanDate" property="loanDate" jdbcType="VARCHAR" />
  <result column="limitDate1" property="limitDate1" jdbcType="VARCHAR" />
  <result column="currency" property="currency" jdbcType="VARCHAR" />
  <result column="amount" property="amount" jdbcType="VARCHAR" />
  <result column="balance" property="balance" jdbcType="VARCHAR" />
  <result column="oweInterest" property="oweInterest" jdbcType="VARCHAR" />
  <result column="currentRate" property="currentRate" jdbcType="VARCHAR" />
  <result column="clientId" property="clientId" jdbcType="BIGINT" />
  <result column="clientName" property="clientName" jdbcType="VARCHAR" />
  <result column="clientType" property="clientType" jdbcType="VARCHAR" />
  <result column="idType" property="idType" jdbcType="VARCHAR" />
  <result column="idNum" property="idNum" jdbcType="VARCHAR" />
  <result column="loanUse" property="loanUse" jdbcType="VARCHAR" />
  <result column="guaranteeType" property="guaranteeType" jdbcType="VARCHAR" />
  <result column="grade" property="grade" jdbcType="VARCHAR" />
  <result column="grade1" property="grade1" jdbcType="VARCHAR" />
  <result column="settleType" property="settleType" jdbcType="VARCHAR" />
  <result column="chargePerson" property="chargePerson" jdbcType="VARCHAR" />
  <result column="organCode" property="organCode" jdbcType="VARCHAR" />
  <result column="organName" property="organName" jdbcType="VARCHAR" />
  <result column="businessType" property="businessType" jdbcType="VARCHAR" />
  <result column="businessBody" property="businessBody" jdbcType="VARCHAR" />
  <result column="provideType" property="provideType" jdbcType="VARCHAR" />
  <result column="invest" property="invest" jdbcType="VARCHAR" />
  <result column="termType" property="termType" jdbcType="VARCHAR" />
  <result column="guaranteeType1" property="guaranteeType1" jdbcType="VARCHAR" />
  <result column="floatScope" property="floatScope" jdbcType="VARCHAR" />
  <result column="adjustType" property="adjustType" jdbcType="VARCHAR" />
  <result column="runType" property="runType" jdbcType="VARCHAR" />
  <result column="frequeency" property="frequeency" jdbcType="VARCHAR" />
  <result column="runitId" property="runitId" jdbcType="VARCHAR" />
  <result column="runitName" property="runitName" jdbcType="VARCHAR" />
</resultMap>
<insert id="save" useGeneratedKeys="true" keyProperty="id" 
	parameterType="com.bank.beans.Loan">
	  
	 insert into t_loan
	 <trim prefix="(" suffix=")" suffixOverrides=",">
	    <if test="clientNum != null ">
	    	clientNum,
	   </if>
	   <if test="noteNum != null ">
	   		noteNum,
	   </if>
	   <if test="compactNum != null ">
	   	    compactNum,
	   </if>
	   <if test="loanDate != null ">
	   		loanDate,
	   </if>
	   <if test="limitDate != null ">
	   		limitDate,
	   </if>
	   <if test="currency != null ">
	   		currency,
	   </if>
	   <if test="amount != null ">
	   		amount,	
	   </if>
	   <if test="balance != null ">
	   		balance,
	   </if>
	   <if test="oweInterest != null ">
	   		oweInterest,
	   </if>
	   <if test="currentRate != null ">
	   		currentRate,
	   </if>
	   <if test="clientId != null ">
	   		clientId,
	   </if>
	   <if test="clientName != null ">
	   		clientName,
	   </if>
	   <if test="clientType != null ">
	   		clientType,
	   </if>
	   <if test="idType != null ">
	   		idType,
	   </if>
	   <if test="idNum != null ">
	   		idNum,
	   </if>
	   <if test="phone != null ">
	   		phone,
	   </if>
	   <if test="address != null ">
	   		address,
	   </if>
	   <if test="loanUse != null ">
	   		loanUse,
	   </if>
	   <if test="guaranteeType != null ">
	   		guaranteeType,
	   </if>
	   <if test="grade != null ">
	   		grade,
	   </if>
	   <if test="grade1 != null ">
	   		grade1,
	   </if>
	   <if test="settleType != null ">
	   		settleType,
	   </if>
	   <if test="chargePerson != null ">
	   		chargePerson,
	   </if>
	   <if test="organCode != null ">
	   		organCode,
	   </if>
	   <if test="organName != null ">
	   		organName,
	   </if>
	   <if test="businessType != null ">
	   		businessType,
	   </if>
	   <if test="businessBody != null ">
	   		businessBody,
	   </if>
	   <if test="provideType != null ">
	   		provideType,
	   </if>
	   <if test="invest != null ">
	   		invest,
	   </if>
	   <if test="termType != null ">
	   		termType,
	   </if>
	   <if test="guaranteeType1 != null ">
	   		guaranteeType1,
	   </if>
	   <if test="floatScope != null ">
	   		floatScope,
	   </if>
	   <if test="adjustType != null ">
	   		adjustType,
	   </if>
	   <if test="runType != null ">
	   		runType,
	   </if>
	   <if test="frequeency != null ">
	   		frequeency,
	   </if>
	   <if test="runitId != null ">
	   		runitId,
	   </if>
	   <if test="runitName != null ">
	   		runitName
	   </if>
	 </trim>
	 <trim prefix="values (" suffix=")" suffixOverrides=",">
	 	<if test="clientNum != null ">
	    	#{clientNum,jdbcType=VARCHAR},
	   </if>
	   <if test="noteNum != null ">
	   		#{noteNum,jdbcType=VARCHAR},
	   </if>
	   <if test="compactNum != null ">
	   	    #{compactNum,jdbcType=VARCHAR},
	   </if>
	   <if test="loanDate != null ">
	   		#{loanDate,jdbcType=VARCHAR},
	   </if>
	   <if test="limitDate != null ">
	   		#{limitDate,jdbcType=VARCHAR},
	   </if>
	   <if test="currency != null ">
	   		#{currency,jdbcType=VARCHAR},
	   </if>
	   <if test="amount != null ">
	   		#{amount,jdbcType=VARCHAR},	
	   </if>
	   <if test="balance != null ">
	   		#{balance,jdbcType=VARCHAR},
	   </if>
	   <if test="oweInterest != null ">
	   		#{oweInterest,jdbcType=VARCHAR},
	   </if>
	   <if test="currentRate != null ">
	   		#{currentRate,jdbcType=VARCHAR},
	   </if>
	   <if test="clientId != null ">
	   		#{clientId,jdbcType=BIGINT},
	   </if>
	   <if test="clientName != null ">
	   		#{clientName,jdbcType=VARCHAR},
	   </if>
	   <if test="clientType != null ">
	   		#{clientType,jdbcType=VARCHAR},
	   </if>
	   <if test="idType != null ">
	   		#{idType,jdbcType=VARCHAR},
	   </if>
	   <if test="idNum != null ">
	   		#{idNum,jdbcType=VARCHAR},
	   </if>
	   <if test="phone != null ">
	   		#{phone,jdbcType=VARCHAR},
	   </if>
	   <if test="address != null ">
	   		#{address,jdbcType=VARCHAR},
	   </if>
	   <if test="loanUse != null ">
	   		#{loanUse,jdbcType=VARCHAR},
	   </if>
	   <if test="guaranteeType != null ">
	   		#{guaranteeType,jdbcType=VARCHAR},
	   </if>
	   <if test="grade != null ">
	   		#{grade,jdbcType=VARCHAR},
	   </if>
	   <if test="grade1 != null ">
	   		#{grade1,jdbcType=VARCHAR},
	   </if>
	   <if test="settleType != null ">
	   		#{settleType,jdbcType=VARCHAR},
	   </if>
	   <if test="chargePerson != null ">
	   		#{chargePerson,jdbcType=VARCHAR},
	   </if>
	   <if test="organCode != null ">
	   		#{organCode,jdbcType=VARCHAR},
	   </if>
	   <if test="organName != null ">
	   		#{organName,jdbcType=VARCHAR},
	   </if>
	   <if test="businessType != null ">
	   		#{businessType,jdbcType=VARCHAR},
	   </if>
	   <if test="businessBody != null ">
	   		#{businessBody,jdbcType=VARCHAR},
	   </if>
	   <if test="provideType != null ">
	   		#{provideType,jdbcType=VARCHAR},
	   </if>
	   <if test="invest != null ">
	   		#{invest,jdbcType=VARCHAR},
	   </if>
	   <if test="termType != null ">
	   		#{termType,jdbcType=VARCHAR},
	   </if>
	   <if test="guaranteeType1 != null ">
	   		#{guaranteeType1,jdbcType=VARCHAR},
	   </if>
	   <if test="floatScope != null ">
	   		#{floatScope,jdbcType=VARCHAR},
	   </if>
	   <if test="adjustType != null ">
	   		#{adjustType,jdbcType=VARCHAR},
	   </if>
	   <if test="runType != null ">
	   		#{runType,jdbcType=VARCHAR},
	   </if>
	   <if test="frequeency != null ">
	   		#{frequeency,jdbcType=VARCHAR},
	   </if>
	    <if test="runitId != null ">
	   		#{runitId,jdbcType=VARCHAR},
	   </if>
	   <if test="runitName != null ">
	   		#{runitName,jdbcType=VARCHAR}
	   </if>
	 </trim>
</insert>
<delete id="delete" parameterType="Long">
	delete from t_loan where loanId = #{id,jdbcType=BIGINT}
</delete>
<update id="update" parameterType="com.bank.beans.Loan">
	update t_loan set clientNum = #{clientNum,jdbcType=VARCHAR},
	noteNum = #{noteNum,jdbcType=VARCHAR},
	compactNum = #{compactNum,jdbcType=VARCHAR},
	loanDate = #{loanDate,jdbcType=VARCHAR},
	limitDate = #{limitDate,jdbcType=VARCHAR},
	limitDate1 = #{limitDate1,jdbcType=VARCHAR},
	currency = #{currency,jdbcType=VARCHAR},
	amount = #{amount,jdbcType=VARCHAR},
	balance = #{balance,jdbcType=VARCHAR},
	oweInterest = #{oweInterest,jdbcType=VARCHAR},
	currentRate = #{currentRate,jdbcType=VARCHAR},
	clientId = #{clientId,jdbcType=VARCHAR},
	clientName = #{clientName,jdbcType=VARCHAR},
	clientType = #{clientType,jdbcType=VARCHAR},
	idType = #{idType,jdbcType=VARCHAR},
	idNum = #{idNum,jdbcType=VARCHAR},
	phone = #{phone,jdbcType=VARCHAR},
	address = #{address,jdbcType=VARCHAR},
	loanUse = #{loanUse,jdbcType=VARCHAR},
	guaranteeType = #{guaranteeType,jdbcType=VARCHAR},
	grade = #{grade,jdbcType=VARCHAR},
	grade1 = #{grade1,jdbcType=VARCHAR},
	settleType = #{settleType,jdbcType=VARCHAR},
	chargePerson = #{chargePerson,jdbcType=VARCHAR},
	organName = #{organName,jdbcType=VARCHAR},
	businessType = #{businessType,jdbcType=VARCHAR},
	businessBody = #{businessBody,jdbcType=VARCHAR},
	provideType = #{provideType,jdbcType=VARCHAR},
	invest = #{invest,jdbcType=VARCHAR},
	termType = #{termType,jdbcType=VARCHAR},
	guaranteeType1 = #{guaranteeType1,jdbcType=VARCHAR},
	floatScope = #{floatScope,jdbcType=VARCHAR},
	adjustType = #{adjustType,jdbcType=VARCHAR},
	runType = #{runType,jdbcType=VARCHAR},
	frequeency = #{frequeency,jdbcType=VARCHAR},
	runitId = #{runitId,jdbcType=VARCHAR},
	runitName = #{runitName,jdbcType=VARCHAR}
	where loanId= #{id,jdbcType=BIGINT}
</update>
<select id="findByPK" parameterType="Long" resultMap="loanResultMap">
	select 
	<include refid="Loan_Column_List" />
	from t_loan
	where loanId = #{loanId,jdbcType=BIGINT}
</select>
<select id="findByID" parameterType="Map" resultMap="loanResultMap">
	select 
	<include refid="Loan_Column_List" />
	from t_loan
	where clientType = #{clientType,jdbcType=INTEGER}
	and idType = #{idType,jdbcType=INTEGER}
	and	idNum = #{idNum,jdbcType=VARCHAR}
</select>
<select id="findByFarmerId" parameterType="long" resultMap="loanResultMap1">
	select a.farmerName,a.farmerIdNum,b.*
	from t_farmer a,t_loan b
	where a.farmerId = b.clientId
	and a.farmerId = #{farmerId,jdbcType=BIGINT}
</select>
<select id="findByFarmers" parameterType="list" resultMap="loanResultMap1">
	select a.farmerName,a.farmerIdNum,b.*
	from t_farmer a,t_loan b
	where a.farmerId = b.clientId
	and clientId in
	<foreach item="item" index="index" collection="list" 
			open="(" separator="," close=")">
	#{item}
	</foreach>
</select>
<select id="findByCompactNum" parameterType="String" resultMap="loanResultMap">
	select 
	<include refid="Loan_Column_List" />
	from t_loan
	where compactNum = #{compactNum,jdbcType = VARCHAR}
</select>
<select id="loan.findByNoteNum" parameterType="String" resultMap="loanResultMap">
	select 
	<include refid="Loan_Column_List" />
	from t_loan
	where noteNum = #{noteNum,jdbcType = VARCHAR}
</select>
<select id="findUnbalanceByFarmer" parameterType="Long" resultMap="loanResultMap">
	select 
	<include refid="Loan_Column_List" />
	from t_loan
	where to_number(balance)>0
	and clientId = #{farmerId,jdbcType = BIGINT}
</select>
<select id="findBadbalanceByFarmer" parameterType="Long" resultMap="loanResultMap">
	select 
	<include refid="Loan_Column_List" />
	from t_loan
	where grade in('3','4','5')
	and clientId = #{farmerId,jdbcType = BIGINT}
</select>
<select id="findSpecialLoan" parameterType="Map" resultMap="loanResultMap">
	select 
	<include refid="Loan_Column_List" />
	from t_loan
	<where>
		<if test="oranName != null and oranName !=''">
			organName = #{organName,jdbcType = VARCHAR}
		</if>
		<if test="loanDate1 != null and loanDate1 !=''">
			<![CDATA[and loanDate >= #{loanDate1,jdbcType = VARCHAR}]]>
		</if>
		<if test="loanDate1 != null and loanDate1 !=''">
			<![CDATA[and loanDate <= #{loanDate1,jdbcType = VARCHAR}]]>
		</if>
		<if test="balance1 != null and balance1 !=''">
			<![CDATA[and balance >= #{balance1,jdbcType = VARCHAR}]]>
		</if>
		<if test="balance2 != null and balance2 !=''">
			<![CDATA[and balance <= #{balance2,jdbcType = VARCHAR}]]>
		</if>
		<if test="clientType != null and clientType !=''">
			and clientType = 1
		</if>
	</where>
</select>
</mapper>